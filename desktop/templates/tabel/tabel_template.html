<!DOCTYPE html>
<html lang="uk">

<head>
    <meta charset="UTF-8">
    <title>Табель обліку робочого часу</title>
    <link rel="stylesheet" href="sheet.css">
</head>

<body>
    <div class="ritz grid-container" dir="ltr">
        <table class="waffle" cellspacing="0" cellpadding="0">
            </thead>
            <tbody>
                <!-- Row 1-2: Header with institution name and title -->
                <tr style="height: 24px">
                    <td class="s0" colspan="4" rowspan="2">{{ institution_name }}</td>
                    <td class="s1" colspan="27" rowspan="2">Табель обліку використання робочого часу</td>
                    <td class="s0" colspan="4" rowspan="2">{{ edrpou_code }}</td>
                </tr>
                <tr style="height: 21px">
                </tr>

                <!-- Row 3: First header row -->
                <tr style="height: 38px">
                    <td class="s3" rowspan="3">№</td>
                    <td class="s3" rowspan="3">Прізвище, ім'я, по-батькові, посада (кількість ставок)</td>
                    <td class="s4" colspan="16">Відтки про явки та неявки за числами місяця (годин)</td>
                    <td class="s3" colspan="6">Відпрацьовано за місяць</td>
                    <td class="s3" colspan="12">з причини за місяць (дн.)</td>
                </tr>

                <!-- Row 4: Day numbers 1-15 -->
                <tr style="height: 66px">
                    <td class="s3">1</td>
                    <td class="s3">2</td>
                    <td class="s3">3</td>
                    <td class="s3">4</td>
                    <td class="s3">5</td>
                    <td class="s3">6</td>
                    <td class="s3">7</td>
                    <td class="s3">8</td>
                    <td class="s3">9</td>
                    <td class="s3">10</td>
                    <td class="s3">11</td>
                    <td class="s3">12</td>
                    <td class="s3">13</td>
                    <td class="s3">14</td>
                    <td class="s3">15</td>
                    <td class="s3">-</td>
                    <td class="s3" rowspan="2">днів</td>
                    <td class="s3" rowspan="2">годин</td>
                    <td class="s3" colspan="4">з них:</td>
                    <td class="s5-vertical">основна та додаткова відпустка</td>
                    <td class="s5-vertical">відпустка у зв'язку з навчанням</td>
                    <td class="s5-vertical">відпустка без збер. зар.плати за згодою</td>
                    <td class="s5-vertical">відп. без збер. зар. плати на пер. навчання</td>
                    <td class="s5-vertical">відрядження</td>
                    <td class="s5-vertical">перевод на неповний робочий день</td>
                    <td class="s5-vertical">тимч. перевод на інше підпр.</td>
                    <td class="s5-vertical">простої</td>
                    <td class="s5-vertical">прогули</td>
                    <td class="s5-vertical">страйки</td>
                    <td class="s5-vertical">тимчасова непрацезд.</td>
                    <td class="s5-vertical">неявки</td>
                </tr>

                <!-- Row 5: Day numbers 16-31 and sub-headers -->
                <tr style="height: 28px">
                    <td class="s3">16</td>
                    <td class="s3">17</td>
                    <td class="s3">18</td>
                    <td class="s3">19</td>
                    <td class="s3">20</td>
                    <td class="s3">21</td>
                    <td class="s3">22</td>
                    <td class="s3">23</td>
                    <td class="s3">24</td>
                    <td class="s3">25</td>
                    <td class="s3">26</td>
                    <td class="s3">27</td>
                    <td class="s3">28</td>
                    <td class="s3">29</td>
                    <td class="s3">30</td>
                    <td class="s3">31</td>
                    <td class="s5">надуроч.</td>
                    <td class="s5">нічних</td>
                    <td class="s5">вечірніх</td>
                    <td class="s5">вихідних, святкових</td>
                    <td class="s5">коди 8-10</td>
                    <td class="s5">коди 11-15, 17, 22</td>
                    <td class="s5">код 18</td>
                    <td class="s5">код 19</td>
                    <td class="s5">код 7</td>
                    <td class="s5">код 20</td>
                    <td class="s5">код 21</td>
                    <td class="s5">код 23</td>
                    <td class="s5">код 24</td>
                    <td class="s5">код 25</td>
                    <td class="s5">коди 26, 27</td>
                    <td class="s5">коди 28-30</td>
                </tr>

                <!-- Employee rows -->
                {% for emp in employees %}
                <!-- First row: Days 1-15 -->
                <tr style="height: 36px">
                    <td class="s6" rowspan="2">{{ loop.index }}</td>
                    <td class="s6" rowspan="2">
                        {{ emp.pib }}<br>
                        {{ emp.position }}{% if emp.rate %}, {{ emp.rate }}{% endif %}
                    </td>
                    <td class="s6">{{ emp.days[0].code }}</td>
                    <td class="s6">{{ emp.days[1].code }}</td>
                    <td class="s6">{{ emp.days[2].code }}</td>
                    <td class="s6">{{ emp.days[3].code }}</td>
                    <td class="s6">{{ emp.days[4].code }}</td>
                    <td class="s6">{{ emp.days[5].code }}</td>
                    <td class="s6">{{ emp.days[6].code }}</td>
                    <td class="s6">{{ emp.days[7].code }}</td>
                    <td class="s6">{{ emp.days[8].code }}</td>
                    <td class="s6">{{ emp.days[9].code }}</td>
                    <td class="s6">{{ emp.days[10].code }}</td>
                    <td class="s6">{{ emp.days[11].code }}</td>
                    <td class="s6">{{ emp.days[12].code }}</td>
                    <td class="s6">{{ emp.days[13].code }}</td>
                    <td class="s6">{{ emp.days[14].code }}</td>
                    <td class="s6"></td>
                    <!-- First half month: worked days and hours -->
                    <td class="s6">{{ emp.totals.first_half_work_days }}</td>
                    <td class="s6">{{ emp.totals.first_half_work_hours }}</td>
                    <!-- First half overtime -->
                    <td class="s7">{{ emp.totals.first_half_overtime or '' }}</td>
                    <td class="s8">{{ emp.totals.first_half_night or '' }}</td>
                    <td class="s9">{{ emp.totals.first_half_evening or '' }}</td>
                    <td class="s8">{{ emp.totals.first_half_weekend or '' }}</td>
                    <!-- Absence totals (first half) -->
                    <td class="s8">{{ emp.absence.vacation_8_10_1 or '' }}</td>
                    <td class="s8">{{ emp.absence.vacation_11_15_1 or '' }}</td>
                    <td class="s8">{{ emp.absence.vacation_18_1 or '' }}</td>
                    <td class="s8">{{ emp.absence.vacation_19_1 or '' }}</td>
                    <td class="s8">{{ emp.absence.business_trip_1 or '' }}</td>
                    <td class="s8">{{ emp.absence.part_time_1 or '' }}</td>
                    <td class="s8">{{ emp.absence.temp_transfer_1 or '' }}</td>
                    <td class="s8">{{ emp.absence.idle_1 or '' }}</td>
                    <td class="s8">{{ emp.absence.absenteeism_1 or '' }}</td>
                    <td class="s8">{{ emp.absence.strike_1 or '' }}</td>
                    <td class="s8">{{ emp.absence.temp_disability_1 or '' }}</td>
                    <td class="s8">{{ emp.absence.unexcused_1 or '' }}</td>
                </tr>
                <!-- Second row: Days 16-31 -->
                <tr style="height: 36px">
                    <td class="s6">{{ emp.days[15].code }}</td>
                    <td class="s6">{{ emp.days[16].code }}</td>
                    <td class="s6">{{ emp.days[17].code }}</td>
                    <td class="s6">{{ emp.days[18].code }}</td>
                    <td class="s6">{{ emp.days[19].code }}</td>
                    <td class="s6">{{ emp.days[20].code }}</td>
                    <td class="s6">{{ emp.days[21].code }}</td>
                    <td class="s6">{{ emp.days[22].code }}</td>
                    <td class="s6">{{ emp.days[23].code }}</td>
                    <td class="s6">{{ emp.days[24].code }}</td>
                    <td class="s6">{{ emp.days[25].code }}</td>
                    <td class="s6">{{ emp.days[26].code }}</td>
                    <td class="s6">{{ emp.days[27].code }}</td>
                    <td class="s6">{{ emp.days[28].code }}</td>
                    <td class="s6">{{ emp.days[29].code }}</td>
                    <td class="s6">{{ emp.days[30].code }}</td>
                    <!-- Second half month: worked days and hours -->
                    <td class="s6">{{ emp.totals.second_half_work_days }}</td>
                    <td class="s6">{{ emp.totals.second_half_work_hours }}</td>
                    <!-- Second half overtime -->
                    <td class="s9">{{ emp.totals.second_half_overtime or '' }}</td>
                    <td class="s8">{{ emp.totals.second_half_night or '' }}</td>
                    <td class="s9">{{ emp.totals.second_half_evening or '' }}</td>
                    <td class="s8">{{ emp.totals.second_half_weekend or '' }}</td>
                    <!-- Absence totals (second half) -->
                    <td class="s8">{{ emp.absence.vacation_8_10_2 or '' }}</td>
                    <td class="s8">{{ emp.absence.vacation_11_15_2 or '' }}</td>
                    <td class="s8">{{ emp.absence.vacation_18_2 or '' }}</td>
                    <td class="s8">{{ emp.absence.vacation_19_2 or '' }}</td>
                    <td class="s8">{{ emp.absence.business_trip_2 or '' }}</td>
                    <td class="s8">{{ emp.absence.part_time_2 or '' }}</td>
                    <td class="s8">{{ emp.absence.temp_transfer_2 or '' }}</td>
                    <td class="s8">{{ emp.absence.idle_2 or '' }}</td>
                    <td class="s8">{{ emp.absence.absenteeism_2 or '' }}</td>
                    <td class="s8">{{ emp.absence.strike_2 or '' }}</td>
                    <td class="s8">{{ emp.absence.temp_disability_2 or '' }}</td>
                    <td class="s8">{{ emp.absence.unexcused_2 or '' }}</td>
                </tr>
                {% endfor %}

                <!-- Totals row -->
                <tr style="height: 17px">
                    <td class="s13" colspan="18">Всього</td>
                    <td class="s14">{{ totals.work_days }}</td>
                    <td class="s14">{{ totals.work_hours }}</td>
                    <!-- Monthly overtime totals -->
                    <td class="s14">{{ totals.overtime or '' }}</td>
                    <td class="s14">{{ totals.night or '' }}</td>
                    <td class="s14">{{ totals.evening or '' }}</td>
                    <td class="s14">{{ totals.weekend or '' }}</td>
                    <!-- Absence totals (monthly) -->
                    <td class="s14">{{ totals.absence.vacation_8_10 or '' }}</td>
                    <td class="s14">{{ totals.absence.vacation_11_15 or '' }}</td>
                    <td class="s14">{{ totals.absence.vacation_18 or '' }}</td>
                    <td class="s14">{{ totals.absence.vacation_19 or '' }}</td>
                    <td class="s14">{{ totals.absence.business_trip or '' }}</td>
                    <td class="s14">{{ totals.absence.part_time or '' }}</td>
                    <td class="s14">{{ totals.absence.temp_transfer or '' }}</td>
                    <td class="s14">{{ totals.absence.idle or '' }}</td>
                    <td class="s14">{{ totals.absence.absenteeism or '' }}</td>
                    <td class="s14">{{ totals.absence.strike or '' }}</td>
                    <td class="s14">{{ totals.absence.temp_disability or '' }}</td>
                    <td class="s14">{{ totals.absence.unexcused or '' }}</td>
                </tr>

                <!-- Empty spacer row -->
                <tr style="height: 35px">
                    <td class="s2" colspan="37"></td>
                </tr>

                <!-- First half month signature -->
                <tr style="height: 20px">
                    <td class="s15" colspan="6">Заповнені дані за I половину місяця підтверджую:</td>
                    <td class="s15" colspan="8">Відповідальна особа за складання</td>
                    <td class="s16" colspan="2"></td>
                    <td class="s17"></td>
                    <td class="s18" colspan="5">{{ responsible_person }}</td>
                    <td class="s15" colspan="5">Керівник структурного підрозділу</td>
                    <td class="s16" colspan="2"></td>
                    <td class="s17"></td>
                    <td class="s18" colspan="6">{{ department_head }}</td>
                </tr>

                <!-- Signature labels row 1 -->
                <tr style="height: 20px">
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s19" colspan="2">(підпис)</td>
                    <td class="s19" colspan="6">(прізвище, ім'я, по-батькові)</td>
                    <td class="s20"></td>
                    <td class="s20"></td>
                    <td class="s20"></td>
                    <td class="s20"></td>
                    <td class="s2"></td>
                    <td class="s19" colspan="2">(підпис)</td>
                    <td class="s20"></td>
                    <td class="s19" colspan="6">(прізвище, ім'я, по-батькові)</td>
                </tr>

                <!-- Empty spacer row -->
                <tr style="height: 25px">
                    <td class="s2" colspan="37"></td>
                </tr>

                <!-- Second half month signature -->
                <tr style="height: 20px">
                    <td class="s15" colspan="6">Заповнені дані за II половину місяця підтверджую:</td>
                    <td class="s15" colspan="8">Відповідальна особа за складання</td>
                    <td class="s16" colspan="2"></td>
                    <td class="s17"></td>
                    <td class="s18" colspan="5">{{ responsible_person }}</td>
                    <td class="s15" colspan="5">Керівник структурного підрозділу</td>
                    <td class="s16" colspan="2"></td>
                    <td class="s17"></td>
                    <td class="s18" colspan="6">{{ department_head }}</td>
                </tr>

                <!-- Signature labels row 2 -->
                <tr style="height: 20px">
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s19" colspan="2">(підпис)</td>
                    <td class="s19" colspan="6">(прізвище, ім'я, по-батькові)</td>
                    <td class="s20"></td>
                    <td class="s20"></td>
                    <td class="s20"></td>
                    <td class="s20"></td>
                    <td class="s2"></td>
                    <td class="s19" colspan="2">(підпис)</td>
                    <td class="s20"></td>
                    <td class="s19" colspan="6">(прізвище, ім'я, по-батькові)</td>
                </tr>

                <!-- Empty spacer row -->
                <tr style="height: 25px">
                    <td class="s2" colspan="37"></td>
                </tr>

                <!-- HR personnel signature row 1 -->
                <tr style="height: 20px">
                    <td class="s15" colspan="2">Працівник кадрової служби</td>
                    <td class="s16" colspan="2"></td>
                    <td class="s17"></td>
                    <td class="s18" colspan="7">{{ hr_person }}</td>
                    <td class="s17"></td>
                    <td class="s16" colspan="3"></td>
                    <td class="s17"></td>
                    <td class="s17"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                </tr>

                <!-- HR signature label row 1 -->
                <tr style="height: 12px">
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s19" colspan="2">(підпис)</td>
                    <td class="s20"></td>
                    <td class="s19" colspan="7">(прізвище, ім'я, по-батькові)</td>
                    <td class="s20"></td>
                    <td class="s23" colspan="3">дата</td>
                    <td class="s20"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                </tr>

                <!-- Empty spacer row -->
                <tr style="height: 25px">
                    <td class="s2" colspan="37"></td>
                </tr>

                <!-- HR personnel signature row 2 -->
                <tr style="height: 20px">
                    <td class="s15" colspan="2">Працівник кадрової служби</td>
                    <td class="s16" colspan="2"></td>
                    <td class="s17"></td>
                    <td class="s18" colspan="7">{{ hr_person }}</td>
                    <td class="s17"></td>
                    <td class="s16" colspan="3"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                </tr>

                <!-- HR signature label row 2 -->
                <tr style="height: 12px">
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s19" colspan="2">(підпис)</td>
                    <td class="s20"></td>
                    <td class="s19" colspan="7">(прізвище, ім'я, по-батькові)</td>
                    <td class="s20"></td>
                    <td class="s23" colspan="3">дата</td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                    <td class="s2"></td>
                </tr>
            </tbody>
        </table>
    </div>
</body>

</html>